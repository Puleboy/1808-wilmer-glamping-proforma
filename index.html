<!-- Full updated HTML with Upsell Inputs -->
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Wilmer Glamping - Investor Pro Forma</title>
  <style>
    body { font-family: Arial, sans-serif; margin: 40px; background-color: #f4f4f4; }
    h1, h2 { color: #333; }
    .section { background-color: white; padding: 20px; margin-bottom: 30px; border-radius: 10px; box-shadow: 0 2px 5px rgba(0,0,0,0.1); }
    table { width: 100%; border-collapse: collapse; margin-top: 10px; }
    th, td { padding: 12px; border: 1px solid #ddd; text-align: left; }
    th { background-color: #e2e2e2; }
    input { width: 100%; padding: 6px; box-sizing: border-box; }
  </style>
</head>
<body>
  <h1>Wilmer Glamping Project - Interactive Investor Pro Forma</h1>

  <div class="section">
    <h2>Assumptions</h2>
    <table>
      <tr><th>Variable</th><th>Input</th></tr>
      <tr><td>Total Units</td><td><input type="number" id="units" value="20"></td></tr>
      <tr><td>Gross Average Nightly Rate ($)</td><td><input type="number" id="rate" value="500"></td></tr>
      <tr><td>Operating Expense Ratio (%)</td><td><input type="number" id="expenseRatio" value="30"></td></tr>
      <tr><td>Occupancy Rate (%)</td><td><input type="number" id="occupancy" value="65"></td></tr>
      <tr><td>Annual Nights Available</td><td><input type="number" id="nights" value="365"></td></tr>
    </table>
  </div>

  <div class="section">
    <h2>Upsell Revenue (Food, Wine, Upgrades)</h2>
    <table>
      <tr><th>Item</th><th>Input</th></tr>
      <tr><td>Average Upsell Revenue Per Guest Night ($)</td><td><input type="number" id="upsell" value="50"></td></tr>
      <tr><td>Upsell Expense Ratio (%)</td><td><input type="number" id="upsellExpenseRatio" value="40"></td></tr>
    </table>
  </div>

  <div class="section">
    <h2>Development Budget</h2>
    <table>
      <tr><th>Item</th><th>Input</th></tr>
      <tr><td>Unit Construction Cost (each)</td><td><input type="number" id="unitCost" value="150000"></td></tr>
      <tr><td>Site Servicing & Infrastructure</td><td><input type="number" id="infra" value="500000"></td></tr>
      <tr><td>Common Facilities</td><td><input type="number" id="facilities" value="200000"></td></tr>
      <tr><td>Soft Costs (% of Hard Costs)</td><td><input type="number" id="softPct" value="15"></td></tr>
      <tr><td>Contingency (% of Hard Costs)</td><td><input type="number" id="contingencyPct" value="10"></td></tr>
    </table>
  </div>

  <div class="section">
    <h2>Financing Structure</h2>
    <table>
      <tr><th>Variable</th><th>Input</th></tr>
      <tr><td>Debt Amount</td><td><input type="number" id="debt" value="400000"></td></tr>
      <tr><td>Preferred Return to LPs (%)</td><td><input type="number" id="prefReturn" value="8"></td></tr>
      <tr><td>LP Profit Split (%)</td><td><input type="number" id="lpSplit" value="80"></td></tr>
      <tr><td>GP Profit Split (%)</td><td><input type="number" id="gpSplit" value="20"></td></tr>
    </table>
  </div>

  <div class="section">
    <h2>Exit Assumptions</h2>
    <table>
      <tr><th>Variable</th><th>Input</th></tr>
      <tr><td>Exit Cap Rate (%)</td><td><input type="number" id="capRate" value="8"></td></tr>
    </table>
  </div>

  <div class="section">
    <button onclick="calculateProForma()">Calculate Pro Forma</button>
    <div id="results" style="margin-top: 20px;"></div>
  </div>

  <script>
    function calculateProForma() {
      const units = parseFloat(document.getElementById('units').value);
      const rate = parseFloat(document.getElementById('rate').value);
      const expenseRatio = parseFloat(document.getElementById('expenseRatio').value) / 100;
      const occupancy = parseFloat(document.getElementById('occupancy').value);
      const nights = parseFloat(document.getElementById('nights').value);
      const upsell = parseFloat(document.getElementById('upsell').value);
      const upsellExpenseRatio = parseFloat(document.getElementById('upsellExpenseRatio').value) / 100;
      const unitCost = parseFloat(document.getElementById('unitCost').value);
      const infra = parseFloat(document.getElementById('infra').value);
      const facilities = parseFloat(document.getElementById('facilities').value);
      const softPct = parseFloat(document.getElementById('softPct').value);
      const contingencyPct = parseFloat(document.getElementById('contingencyPct').value);
      const debt = parseFloat(document.getElementById('debt').value);
      const prefReturn = parseFloat(document.getElementById('prefReturn').value);
      const lpSplit = parseFloat(document.getElementById('lpSplit').value);
      const gpSplit = parseFloat(document.getElementById('gpSplit').value);
      const capRate = parseFloat(document.getElementById('capRate').value);

      const hardCosts = units * unitCost + infra + facilities;
      const soft = hardCosts * (softPct / 100);
      const contingency = hardCosts * (contingencyPct / 100);
      const totalCapex = hardCosts + soft + contingency;

      const guestNights = units * (occupancy / 100) * nights;
      const grossRevenue = guestNights * rate;
      const netBaseRevenue = grossRevenue * (1 - expenseRatio);

      const grossUpsell = guestNights * upsell;
      const netUpsell = grossUpsell * (1 - upsellExpenseRatio);

      const totalNetRevenue = netBaseRevenue + netUpsell;

      const equity = totalCapex - debt;
      const prefPayment = equity * (prefReturn / 100);
      const remaining = totalNetRevenue - prefPayment;
      const lpProfit = remaining * (lpSplit / 100);
      const gpProfit = remaining * (gpSplit / 100);

      const exitValue = totalNetRevenue / (capRate / 100);

      document.getElementById('results').innerHTML = `
        <h2>Pro Forma Summary</h2>
        <table>
          <tr><td>Gross Revenue (Room)</td><td>$${grossRevenue.toLocaleString()}</td></tr>
          <tr><td>Net Room Revenue</td><td>$${netBaseRevenue.toLocaleString()}</td></tr>
          <tr><td>Gross Upsell Revenue</td><td>$${grossUpsell.toLocaleString()}</td></tr>
          <tr><td>Net Upsell Revenue</td><td>$${netUpsell.toLocaleString()}</td></tr>
          <tr><td><strong>Total Net Revenue</strong></td><td><strong>$${totalNetRevenue.toLocaleString()}</strong></td></tr>
          <tr><td>Total Development Cost</td><td>$${totalCapex.toLocaleString()}</td></tr>
          <tr><td>Equity Required</td><td>$${equity.toLocaleString()}</td></tr>
          <tr><td>Preferred Return to LPs</td><td>$${prefPayment.toLocaleString()}</td></tr>
          <tr><td>Remaining Distributable Cash</td><td>$${remaining.toLocaleString()}</td></tr>
          <tr><td>LP Profit Share</td><td>$${lpProfit.toLocaleString()}</td></tr>
          <tr><td>GP Profit Share</td><td>$${gpProfit.toLocaleString()}</td></tr>
          <tr><td><strong>Exit Value @ ${capRate}% Cap Rate</strong></td><td>$${exitValue.toLocaleString()}</td></tr>
        </table>
      `;
    }
  </script>
</body>
</html>
